<%- model_class = Order -%>

<div class="page-header">
  <h1>Commandes</h1>
</div>

<table class="table table-striped" id="orders-index-table">
  <tbody>
    <% @orders.each do |order| %>
      <div class="items">
        <!-- une ligne pour l'en-tête de la commande -->
        <tr class="order">
          <td>Commande n° <%= order.id %></td>
          <td>Passée à <%= order.created_at.strftime("%H:%M") %></td>
          <td>Table n° TODO</td>
          <td>Payé: 
            <% if order.is_paid == true %>
              <font color="green"> ✔ </font>
            <% else %>
              <font color="red"> ✘ </font>
            <% end %>
          </td>
          <td>Servi: 
            <% if order.is_served == true %>
              <font color="green"> ✔ </font>
            <% else %>
              <font color="red"> ✘ </font>
            <% end %>
          </td>
          <td>
            <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                order_path(order), :method => :delete,
                :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", 
                :default => 'Êtes-vous sûr de vouloir supprimer cette commande ?')) },
                :class => 'btn btn-xs btn-danger' %>
          </td>
          <td width="160px">Prix total: TODO</td>
        </tr>
        <!-- une ligne pour contenir un sous-tableau avec les items commandés -->
        <tr>
          <td colspan="7">
            <table class="table">
              <tbody>
                <% order.items.each do |item| %>
                  <tr>
                    <td>Article: <strong><%= item.article.name %></strong></td>
                    <td><%= item.comments %></td>
                    <td>Quantité: <strong>1</strong></td>
                    <td width="150px">Prix: <%= number_to_currency(item.article.price, :locale => :fr) %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </td>
        </tr>
      </div>
    <% end %>
  </tbody>
</table>
